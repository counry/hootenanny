#!/bin/bash
set -e

REF_DIR=test-files/cmd/quick/DeriveImplicitTagRulesDatabaseCmdTest
OUTPUT_DIR=test-output/cmd/quick/DeriveImplicitTagRulesDatabaseCmdTest
INPUT_DIR=test-files/schema/DeriveRawImplicitTagRulesCmdTest

rm -rf $OUTPUT_DIR
mkdir -p $OUTPUT_DIR

# TODO: combine logic into single test and invoke implicit tagger after generating database
hoot implicit-tagging-derive-raw-rules --warn poi $INPUT_DIR/DeriveRawImplicitTagRulesCmdTest.implicitTagRules "$OUTPUT_DIR/DeriveImplicitTagRulesDatabaseCmdTest-out.sqlite"

#only checking the json and tsv files here
#diff $REF_DIR/DerivePoiImplicitTagRulesCmdTest.json $OUTPUT_DIR/DerivePoiImplicitTagRulesCmdTest-out.json
#diff $REF_DIR/DerivePoiImplicitTagRulesCmdTest.tsv $OUTPUT_DIR/DerivePoiImplicitTagRulesCmdTest-out.tsv

#TODO: check db contents?
 
